a)SELECT idPeca FROM Peca WHERE custoUnitario<10 AND codigo like '%98%'
b)SELECT matricula FROM Carro, Reparacao WHERE Carro.idCarro=Reparacao.idCarro AND strftime('%m', dataFim) = '09' AND strftime('%Y', dataFim) = '2010';
c)SELECT nome FROM Cliente, Carro, Reparacao, ReparacaoPeca, Peca
	WHERE Cliente.idCliente=Carro.idCliente
	AND Carro.idCarro=Reparacao.idCarro
	AND Reparacao.idReparacao=ReparacaoPeca.idReparacao
	AND ReparacaoPeca.idPeca=Peca.idPeca
	AND custoUnitario>10
	ORDER BY custoUnitario DESC;
d)SELECT nome FROM Cliente WHERE idCliente not in (SELECT idCliente FROM Carro);
e)SELECT idCarro, count(*) FROM Reparacao GROUP BY idCarro;
f)SELECT idCarro, sum(julianday(dataFim)-julianday(dataFim)) FROM Reparacao GROUP BY idCarro;
g)SELECT avg(custoUnitario), sum(custoUnitario * quantidade), sum(quantidade), max(custoUnitario), min(custoUnitario) FROM Peca; 
h)--

	CREATE VIEW PrecoReparacao1 AS 
	SELECT FuncionarioReparacao.idReparacao AS idReparacao,
	ifnull(SUM(Especialidade.custoHorario*FuncionarioReparacao.numHoras),0) AS precoFuncionario
	FROM Especialidade, Funcionario, FuncionarioReparacao
	WHERE Especialidade.idEspecialidade=Funcionario.idEspecialidade
	AND Funcionario.idFuncionario=FuncionarioReparacao.idFuncionario
	GROUP BY FuncionarioReparacao.idReparacao;

	CREATE VIEW PrecoReparacao2 AS
	SELECT ReparacaoPeca.idReparacao AS idReparacao,
	ifnull(SUM(Peca.custoUnitario*ReparacaoPeca.quantidade),0) AS
	precoPeca
	FROM ReparacaoPeca, Peca
	WHERE ReparacaoPeca.idPeca=Peca.idpeca
	GROUP BY ReparacaoPeca.idReparacao;
	 
	CREATE VIEW precoReparacao AS
	SELECT ifnull(idReparacao1,idReparacao2) AS idReparacao,
	ifnull(precoFuncionario,0) + ifnull(precoPeca,0) AS preco
	FROM
	(SELECT PrecoReparacao1.idReparacao AS idReparacao1,
	PrecoReparacao1.precoFuncionario, PrecoReparacao2.idReparacao AS
	idReparacao2, PrecoReparacao2.precoPeca
	FROM PrecoReparacao1
	LEFT JOIN PrecoReparacao2
	ON PrecoReparacao1.idReparacao = PrecoReparacao2.idReparacao
	UNION ALL

	SELECT PrecoReparacao1.idReparacao AS idReparacao1,
	PrecoReparacao1.precoFuncionario, PrecoReparacao2.idReparacao AS
	idReparacao2, PrecoReparacao2.precoPeca
	FROM PrecoReparacao2
	LEFT JOIN PrecoReparacao1
	ON PrecoReparacao1.idReparacao = PrecoReparacao2.idReparacao
	WHERE PrecoReparacao1.idReparacao IS NULL);

i)SELECT * FROM PrecoReparacao
j)
k)SELECT Cliente.idCliente, nome FROM Cliente, Carro, Reparacao, (SELECT idReparacao as idMaisCaro, max(preco) FROM precoReparacao)
	WHERE  Cliente.idCliente = Carro.idCliente AND Carro.idCarro=Reparacao.idCarro
	AND idMaisCaro = Reparacao.idReparacao;

	SELECT nome
	FROM Cliente, Carro, Reparacao, PrecoReparacao
	WHERE Cliente.idCliente=Carro.idCliente
	AND Carro.idCarro=Reparacao.idCarro
	AND Reparacao.idReparacao=PrecoReparacao.idReparacao
	AND PrecoReparacao.preco = (SELECT MAX(preco) FROM
	PrecoReparacao);

